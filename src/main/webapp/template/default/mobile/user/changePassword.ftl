<#import "/common/app.ftl" as app> <#include "/common/common.ftl" /><!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="Content-Language" content="zh-CN"><meta name="keywords" content=""><meta name="description" content=""><meta name="copyright" content="" /><meta name="viewport" content="initial-scale=1,maximum-scale=1,minimum-scale=1"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><title>修改密码</title><!-- css --><link href="${app.basePath}/static/touch/css/common.css" rel="stylesheet" type="text/css" /><link href="${app.basePath}/static/touch/css/main.css" rel="stylesheet" type="text/css" /><link href="${app.basePath}/static/touch/css/x_pc.css" rel="stylesheet" type="text/css" /><!-- js --><script type="text/javascript" src="${app.basePath}/static/touch/js/jquery-1.9.1.min.js"></script><script type="text/javascript" src="${app.basePath}/static/js/Validform_v5.3.2_min.js"></script><script type="text/javascript" src="${app.basePath}/static/touch/js/common.js"></script><script src="${app.basePath}/static/js/mobile/user/user.js" type="text/javascript"></script></head><body class="body_gray">  <!-- header_top -->  <div class="top_heater">    <a href="${app.basePath}/mobile/user/center" title="返回个人中心" class="hleft hback"></a>    <span>修改密码</span>  </div>  <!-- header_top end -->  <!-- Center Start -->  <section class="container change-password">    <form id="changePassWordForm" action="${app.basePath}/mobile/user/savePassword">      <div class="inpt">        <label>原始密码</label>        <input type="password" id="oldPassword" name="oldPassword" placeholder="请输入原始密码" datatype="*6-15" nullmsg="请填写原始密码！" errormsg="密码范围在6~15位之间！">      </div>      <div class="get-code">        <label>图形验证码</label>        <input type="text" id="verifyCode" datatype="*" nullmsg="请填写验证码！">        <a href="#"><img src="${app.basePath}/authImage" style="width:129;height:47;" onclick="fushVerifyCode()" id="getVerifyCode"></a>      </div>      <div class="get-code">        <label>手机验证码</label>        <input type="text" name="valideCode" id="valideCode" datatype="*" nullmsg="请填写验证码！">        <a href="javascript:;" id="getChangeUserPasswordValidCode" title="获取验证码">获取验证码</a>      </div>      <div class="inpt">        <label>新密码</label>        <input type="password" id="newPassword" name="newPassword" placeholder="请输入新密码" datatype="*6-15" nullmsg="请填写新密码！" errormsg="密码范围在6~15位之间！">      </div>      <div class="inpt">        <label>重复输入</label>        <input type="password" id="newPassword2" name="newPassword2" placeholder="请再次输入新密码" datatype="*" recheck="newPassword" nullmsg="请重复新密码！" errormsg="您两次输入的账号密码不一致！">      </div>  </section>  <!-- Center End -->  <div class="clear" style="width:100%;height:.8rem;"></div>  <a class="btn-now-withdraw" id="goChangePassword" href="javascript:;" title="提交修改">提交修改</a>  </form></body><script>	$(document).ready(function(){		// 初始化ValidForm插件		$("#changePassWordForm").Validform({			tiptype:function(msg,o,cssctl){			    //msg：提示信息;			    //o:{obj:*,type:*,curform:*},			    //obj指向的是当前验证的表单元素（或表单对象，验证全部验证通过，提交表单时o.obj为该表单对象），			    //type指示提示的状态，值为1、2、3、4， 1：正在检测/提交数据，2：通过验证，3：验证失败，4：提示ignore状态, 			    //curform为当前form对象;			    //cssctl:内置的提示信息样式控制函数，该函数需传入两个参数：显示提示信息的对象 和 当前提示的状态（既形参o中的type）;			    if(o.type == 3){			    	alert(msg);			    }			},			postonce:true, // 开启二次提交防御			ajaxPost:true, 			callback:function(data){				//返回数据data是json对象，{"info":"demo info","status":"y"}				//info: 输出提示信息;				//status: 返回提交数据的状态,是否提交成功。如可以用"y"表示提交成功，"n"表示提交失败，在ajax_post.php文件返回数据里自定字符，主要用在callback函数里根据该值执行相应的回调操作;				alert(data.info);				if(data.staus == "y"){					window.location.href=basePath+"/mobile/user/center";									}			}		});				// 为提交按钮绑定事件		$("#goChangePassword").bind("click", function(){		  $("#changePassWordForm").submit();		});		// 为获取验证按钮绑定获取验证码事件		$("#getChangeUserPasswordValidCode").bind("click", function(){						var vurl = basePath+"/mobile/user/verifyCode";			var vcode =	$("#verifyCode").val();			if(vcode == ""){				alert("请输入图形验证码");				return;			}			var vdata = {'vcode': vcode};			$.post(vurl, vdata, function(data){				var jdata = eval('('+data+')');				if(jdata.code == 0){					alert(jdata.msg);					return;				}else{					isWait = true;					waitSeconds($("#getChangeUserPasswordValidCode"));					var url = basePath+"/mobile/user/getChangeUserPasswordValidCode";					$.post(url, function(pdata){						var result = eval("("+pdata+")");						alert('消息提醒'+result.msg);						isWait = false;					}, "text");				}			}, "text");		});		// 为获取验证按钮绑定等待60秒事件		$("#getChangeUserPasswordValidCode").bind("click", function(){			if(isWait){				waitSeconds($("#getChangeUserPasswordValidCode"));						}		});	});			//刷新图形验证码src	function fushVerifyCode(){		var src = $("#getVerifyCode").attr("src");		var rnum = getRandom(99999);		$("#getVerifyCode").attr("src", src + "?rnum=" + rnum);	}	//产生随机数	function getRandom(n){    	return Math.floor(Math.random()*n+1)    }</script></html>