<#import "/common/app.ftl" as app> <#include "/common/common.ftl" /><!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <meta http-equiv="Content-Language" content="zh-CN">    <meta name="keywords" content="">    <meta name="description" content="">    <meta name="copyright" content=""/>    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">    <meta content="yes" name="apple-mobile-web-app-capable">    <meta content="black" name="apple-mobile-web-app-status-bar-style">    <meta content="telephone=no" name="format-detection">    <title>创客联盟</title>    <!-- css -->    <link href="${app.basePath}/static/touch/css/common.css" rel="stylesheet" type="text/css"/>    <link href="${app.basePath}/static/touch/css/main.css" rel="stylesheet" type="text/css"/>    <link href="${app.basePath}/static/touch/css/f-personalcenter.css" rel="stylesheet" type="text/css"/>    <!-- js -->    <script type="text/javascript" src="${app.basePath}/static/touch/js/jquery-1.9.1.min.js"></script>    <script type="text/javascript" src="${app.basePath}/static/touch/js/common.js"></script></head><body class="body_gray"><!-- header_top --><div class="top_heater">    <a href="${app.basePath}/mobile/user/productManage" title="返回商品管理" class="hleft hback"></a>    <span>查看我的商品</span>    <a href="javascript:;" onclick="$(this).siblings('.search-wrap').slideToggle();" class="hright h-search" title="">查找</a>    <div class="search-wrap">        <input type="text" id="searchInput"/>        <input type="button" value="确认" id="searchButton" onclick="searchProduct()" class="btnsure"/>    </div></div><!-- header_top end --><!-- Center Start --><section class="container my-product">    <article class="nav">        <a href="javascript:;" class="current" title="所有商品" id="allProductATag">所有商品</a>        <a href="javascript:;" title="未上架" id="unsellProductATag">未上架</a>        <a href="javascript:;" title="已上架" id="sellProductATag">已上架</a>    </article>    <ol>        <!--所有商品-->        <li style="display: none;" id="allProductLiTag">        </li>        <!--未上架-->        <li style="display: none;" id="unsellProductLiTag">        </li>        <!--已上架-->        <li style="display: none;" id="sellProductLiTag">        </li>                <!--查询-->        <li style="display: none;" id="searchProductLiTag">        </li>    </ol></section><script type="text/javascript">	var currentLiTag = "";	var allProductPageNo= 0;	var unsellProductPageNo= 0;	var sellProductPageNo= 0;	var searchProductPageNo = 0;    $(function () {    	// 点击a标签        function tab(tabTitle, tabList) {            $(tabTitle).on('click', 'a', function () {                var $self = $(this);//当前a标签                var index = $(this).index();//当前索引                $self.addClass('current').siblings('a').removeClass('current');                $(tabList).find('>li').eq(index).show().siblings('li').hide();                currentLiTag = $(tabList).find('>li').eq(index).attr("id");                resetParam();                rollingLoad(currentLiTag);                // 滚动触发		        $(window).off("scroll").on("scroll",function () {			        var scrollTop = $(this).scrollTop();			        var scrollHeight = $(document).height();			        var windowHeight = $(this).height();			        var isTheFirstTime = $("#isTheFirstTime").val();			        if (scrollTop + windowHeight == scrollHeight){						rollingLoad(currentLiTag);				    }			    });            });        }        tab('.my-product .nav', '.my-product ol');        // 首次加载默认点击第一个a标签        $("#allProductATag").click();    });        // 按商品名搜索    function searchProduct(){    	currentLiTag = "searchProductLiTag";    	resetParam();    	$("#searchProductLiTag").show().siblings('li').hide();    	rollingLoad(currentLiTag);    }        // 重置参数    function resetParam(){    	allProductPageNo= 0;        unsellProductPageNo= 0;        sellProductPageNo= 0;        searchProductPageNo = 0;        $("#searchProductLiTag").html("");        $("#sellProductLiTag").html("");        $("#unsellProductLiTag").html("");        $("#allProductLiTag").html("");    }        // 滚动加载    function rollingLoad(currentLiTag){    	var loadData;    	if(currentLiTag =="allProductLiTag"){    		allProductPageNo ++;    		loadData = {'pageNo': allProductPageNo};    	}else if(currentLiTag == "unsellProductLiTag"){    		unsellProductPageNo ++;    		loadData = {'pageNo': unsellProductPageNo, 'onshelf': 'false'};    	}else if(currentLiTag == "sellProductLiTag"){    		sellProductPageNo ++;    		loadData = {'pageNo': sellProductPageNo, 'onshelf': 'true'};    	}else if(currentLiTag == "searchProductLiTag"){    		searchProductPageNo ++;    		var searchWords = $("#searchInput").val();    		loadData = {'pageNo': searchProductPageNo, 'name': searchWords};    	}    	var url = basePath+"/mobile/user/searchMyProduct";    	$.post(url, loadData, function(data){    		$("#"+currentLiTag).append(data);    	}, "text");    }        // 去上下架    function goOnshelf(id, onshelf){    	var url = basePath+"/mobile/user/goOnshelf";    	var loadData = {'id': id, 'onshelf': onshelf};    	$.post(url, loadData, function(data){    		var jsonData = eval('('+data+')');    		alert(jsonData.msg);    		if(jsonData.code == "1"){    			//定位该商品    			var rollingNum = 0;    			var clickATag = "";    			if(currentLiTag =="allProductLiTag"){		    		rollingNum = allProductPageNo;		    		clickATag = "allProductATag";		    	}else if(currentLiTag == "unsellProductLiTag"){		    		rollingNum = unsellProductPageNo;		    		clickATag = "unsellProductATag";		    	}else if(currentLiTag == "sellProductLiTag"){		    		rollingNum = sellProductPageNo;		    		clickATag = "sellProductATag";		    	}else if(currentLiTag == "searchProductLiTag"){		    		rollingNum = searchProductPageNo;		    		clickATag = "searchButton";		    	}		    	console.log("rollingNum: " + rollingNum);		    	console.log("currentLiTag: " + currentLiTag);		    	$("#"+clickATag).click();		    	for(var i = 0; i < rollingNum; i ++){		    		rollingLoad(currentLiTag);		    	}		    }    	}, "text");    }    </script><!-- Center End --></body></html>