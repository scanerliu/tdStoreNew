<#import "/common/app.ftl" as app> <!DOCTYPE html><html lang="en"><head>	<meta charset="UTF-8">    <meta name="description" content="中国创客联盟"/>    <meta name="keywords" content="中国创客联盟"/>    <meta name="author" content="中国创客联盟"/>    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>    <title>我的订单- ${system.webkeywords!''}</title>    <!-- 网站图标 -->    <link rel="shortcut icon" href="${app.basePath}/static/default/images/icon.ico" />    <!-- css -->    <link rel="stylesheet" href="${app.basePath}/static/default/client/style/site.css" type="text/css"/>    <link rel="stylesheet" type="text/css" href="${app.basePath}/static/default/client/style/personal-center-common.css">    <link rel="stylesheet" type="text/css" href="${app.basePath}/static/default/client/style/f_personal_center.css">    <link rel="stylesheet" type="text/css" href="${app.basePath}/static/default/client/style/lhead.css">    <link rel="stylesheet" type="text/css" href="${app.basePath}/static/default/client/style/index.css">    <link rel="stylesheet" type="text/css" href="${app.basePath}/static/default/client/style/has.css">	<#include "/common/common.ftl" />    <!-- js -->    <script type="text/javascript" src="${app.basePath}/static/js/jquery-1.12.3.min.js"></script>    <script type="text/javascript" src="${app.basePath}/static/js/client/html5.js"></script>    <!--通用js-->    <script type="text/javascript" src="${app.basePath}/static/js/client/core.js"></script>    <script type="text/javascript" src="${app.basePath}/static/js/client/common.js"></script>    <script type="text/javascript" src="${app.basePath}/static/js/client/index.js"></script>    <script src="${app.basePath}/static/js/uploadify/jquery.uploadify.js" type="text/javascript"></script>    <script type="text/javascript" src="${app.basePath}/static/js/Validform_v5.3.2_min.js"></script>    <style>    	.diliver .obody .image ul{position: relative; top: 0;left: 0;visibility: visible; }    </style></head><h1 style="display:none;"></h1>	<!-- Header -->	<#include "../../common/centerheader.ftl">	<!-- Header -->	<div class="clear"></div>	<!-- Center Start -->	<div class="index-main">	    <div class="personal-center">	        <!-- 左侧导航 -->        	<#include "../../common/centerleftmenu.ftl">        		        <!-- 右边 -->	        <div class="right-content get_reward">	        	<div class="diliver white_box all_nation">	                <div class="otitle">	                    <label for="" class="lab1 fl">评价商品</label>	                </div>		            <div class="box1">		            <!-- 列表 -->		            <form id="commentform"  action="${app.basePath}/user/comment/add" method="post">		            <input type="hidden" value="${order.orderId?c}" name="orderId">		            <#if order.skuList??>	    			<#list order.skuList as sku>		            <div class="obody">	                    <ul class="active">	                      <!-- 单行商品 -->	                      <li>	                        <input type="hidden" value="${sku.orderSkuId?c}" name="skuId">      						<input type="hidden" value="${sku.productId?c}" name="productId">	                        <div class="goodsorder_detail">	                          <div class="fl goodsorder_detail_left w590">	                            <dl class="fl">	                              <dt class="fl"><img src="${app.basePath}${sku.productImage!''}" alt="" /></dt>	                              <dd class="dd1 w240 fl">	                                <p class="p1">${sku.productName!''}</p>	                                <p class="p2">	                                	<#if sku.specialList??>						              	<#list sku.specialList as special>						              	<label for="">${special.sname!''}：${special.soption!''}</label>						                </#list>						                </#if>	                                </p>	                              </dd>	                            </dl>	                          </div>	                        </div>	                      </li>	                    </ul>	                    <div class="fig fig2">			                <label for="" class="lab1 fl">上传照片</label>			                <section class="sig fl image">			                    <ul id="imglist${sku_index}">			                        <li class="li1">			                            <input type="file" id="file_uploads${sku_index}" style="width:1000px;"/>			                        </li>			                    </ul>			                    <p class="pig">小提示：上传已购买商品的自拍图片</p>			                </section>			            </div>	                    <div class="reviews-content">	                        <div class="left" Validform_label>评价内容</div>	                        <textarea class="right" name="content" datatype="*5-50"></textarea>	                     </div>	                     <!-- 评分 -->			              <div class="score">			                <div class="left">评价等级</div>			                <!--评价星星-->			                <div class="reviewsbox" id="reviewsbox${sku_index}">			                  <a href="javascript:void(0);" class="">&nbsp;</a>			                  <a href="javascript:void(0);" class="">&nbsp;</a>			                  <a href="javascript:void(0);" class="">&nbsp;</a>			                  <a href="javascript:void(0);" class="">&nbsp;</a>			                  <a href="javascript:void(0);" class="">&nbsp;</a>			                </div>			              </div><!-- 评分 END -->			              <input type="hidden" value="" name="score" id="score${sku_index}" datatype="n1-5" nullmsg="请勾选评分！">	                    <script>	    				$(function(){					    	var num${sku_index} = 0;							$('#file_uploads${sku_index}').uploadify({								'multi': true, // 限制单图上传								'auto': true,								'formData' : {'type' : 'comment'},								'swf'      : basePath+'/static/js/uploadify/uploadify.swf', // swf存放的路径								'fileObjName' : 'file',								'uploader' : basePath+'/uploadify/upload/singleFile',    // 处理上传的Servlet								'fileBrowserButtonId':'file_upload${sku_index}',								'buttonText' : '',								'onUploadSuccess' : function(file, data, response) {									var result = eval("("+data+")");									var imgs = $("#imglist${sku_index} li").length;									var file = '';									if(imgs <= 4){										num${sku_index} ++ ;										$("#imglist${sku_index}").append("<li><img src='"+ basePath+result.savedFile +"' alt='图片不存在'/><a 'javascript:;' title='删除图片' class='aclose' onclick='deleteimg(this)'></a> <input type='hidden' name='images[${sku_index}]' value='"+result.savedFile+"'/></li>");									}else{										alert("最多上传图片数量为3张")									}						        },						        'onUploadError' : function(file, errorCode, errorMsg, errorString) {						        	alert("上传失败。");						        }						});						reviewsBox("${sku_index}","a","sel");					});				    </script>				    </div>				    </#list>				    </#if>	                <div class="score">		                <div class="left">匿名评论</div>		                <!--评价星星-->		                <div class="reviewsbox">		                <label><input type="checkbox" name="anonymous" value="true" checked="checked"/>是</label>		                </div>		              </div>		              <input class="btn-sub-reviews" type="submit" value="发表评论">		            </form>		         </div>	        </div>	    </div>	    <div class="clear"></div>	</div>	<!-- Center End -->	<!-- Footer Start -->	<#include "../../common/commonfooter.ftl">	<!-- Footer End -->    <script type="text/javascript">      $(function(){      });      function reviewsBox(boxid,_name,_hover){          var _box = $("#reviewsbox"+boxid);          var _arr = _box.find(_name);          var _index = 0;          var _now = _box.find("."+_hover).length;                    var _checkNow = function(_num){            _arr.removeClass(_hover);              for(var i=0;i<=_num;i++){                _arr.eq(i).addClass(_hover);                }            };//fun END                      // hover效果          _arr.hover(function(){            _index = $(this).index();            _checkNow(_index);            },function(){              _checkNow(_now-1);              $("#score"+boxid).attr("value",_now)          });          // 点击效果          _arr.click(function(){                _now = $(this).index();                for(var i=0;i<=_now;i++){                _arr.eq(i).addClass(_hover);                }              _now += 1;              $("#score"+boxid).attr("value",_now)            });        };	      $("#commentform").Validform({			tiptype:function(msg,o,cssctl){			    //msg：提示信息;			    //o:{obj:*,type:*,curform:*},			    //obj指向的是当前验证的表单元素（或表单对象，验证全部验证通过，提交表单时o.obj为该表单对象），			    //type指示提示的状态，值为1、2、3、4， 1：正在检测/提交数据，2：通过验证，3：验证失败，4：提示ignore状态, 			    //curform为当前form对象;			    //cssctl:内置的提示信息样式控制函数，该函数需传入两个参数：显示提示信息的对象 和 当前提示的状态（既形参o中的type）;			    if(o.type == 3){			    	alert(msg);			    }			},			beforeCheck:function(curform){			},			beforeSubmit:function(curform){			 	openwaiting();			},			postonce:true, // 开启二次提交防御			ajaxPost:true, 			callback:function(data){				closewaiting();				alert(data.msg);				if(data.code == 1){					window.location.href=basePath+"/user/commentlist";				}			}		});      function deleteimg(obj){			$(obj).parent().remove();		}    </script></body></html>